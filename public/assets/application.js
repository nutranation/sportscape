






//
//geo-location-javascript v0.4.8
//http://code.google.com/p/geo-location-javascript/
//
//Copyright (c) 2009 Stan Wiechers
//Licensed under the MIT licenses.
//
//Revision: $Rev: 77 $: 
//Author: $Author: whoisstan@gmail.com $:
//Date: $Date: 2011-01-11 14:57:50 -0500 (Tue, 11 Jan 2011) $:    
//
function handleBlackBerryLocationTimeout(){bb_blackberryTimeout_id!=-1&&bb_error({message:"Timeout error",code:3})}function handleBlackBerryLocation(){clearTimeout(bb_blackberryTimeout_id),bb_blackberryTimeout_id=-1;if(bb_success&&bb_error){if(blackberry.location.latitude==0&&blackberry.location.longitude==0)bb_error({message:"Position unavailable",code:2});else{var a=null;blackberry.location.timestamp&&(a=new Date(blackberry.location.timestamp)),bb_success({timestamp:a,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_success=null,bb_error=null}}var bb_success,bb_error,bb_blackberryTimeout_id=-1,geo_position_js=function(){var a={},b=null,c="undefined";return a.showMap=function(a,b){typeof blackberry!=c?blackberry.launch.newMap({latitude:a*1e5,longitude:-b*1e5}):window.location="http://maps.google.com/maps?q=loc:"+a+","+b},a.getCurrentPosition=function(a,c,d){b.getCurrentPosition(a,c,d)},a.init=function(){try{if(typeof geo_position_js_simulator!=c)b=geo_position_js_simulator;else if(typeof bondi!=c&&typeof bondi.geolocation!=c)b=bondi.geolocation;else if(typeof navigator.geolocation!=c)b=navigator.geolocation,a.getCurrentPosition=function(a,d,e){function f(b){typeof b.latitude!=c?a({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude}}):a(b)}b.getCurrentPosition(f,d,e)};else if(typeof window.blackberry!=c&&blackberry.location.GPSSupported){if(typeof blackberry.location.setAidMode==c)return!1;blackberry.location.setAidMode(2),a.getCurrentPosition=function(a,b,c){bb_success=a,bb_error=b,c.timeout?bb_blackberryTimeout_id=setTimeout("handleBlackBerryLocationTimeout()",c.timeout):bb_blackberryTimeout_id=setTimeout("handleBlackBerryLocationTimeout()",6e4),blackberry.location.onLocationUpdate("handleBlackBerryLocation()"),blackberry.location.refreshLocation()},b=blackberry.location}else typeof window.google!=c&&typeof google.gears!=c?b=google.gears.factory.create("beta.geolocation"):typeof Mojo!=c&&typeof Mojo.Service.Request!="Mojo.Service.Request"?(b=!0,a.getCurrentPosition=function(a,b,c){parameters={},c&&(c.enableHighAccuracy&&c.enableHighAccuracy==1&&(parameters.accuracy=1),c.maximumAge&&(parameters.maximumAge=c.maximumAge),c.responseTime&&(c.responseTime<5?parameters.responseTime=1:c.responseTime<20?parameters.responseTime=2:parameters.timeout=3)),r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(b){a({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude,heading:b.heading}})},onFailure:function(a){a.errorCode==1?b({code:3,message:"Timeout"}):a.errorCode==2?b({code:2,message:"Position unavailable"}):b({code:0,message:"Unknown Error: webOS-code"+errorCode})}})}):typeof device!=c&&typeof device.getServiceObject!=c&&(b=device.getServiceObject("Service.Location","ILocation"),a.getCurrentPosition=function(a,c,d){function e(b,d,e){d==4?c({message:"Position unavailable",code:2}):a({timestamp:null,coords:{latitude:e.ReturnValue.Latitude,longitude:e.ReturnValue.Longitude,altitude:e.ReturnValue.Altitude,heading:e.ReturnValue.Heading}})}var f=new Object;f.LocationInformationClass="BasicLocationInformation",b.ILocation.GetLocation(f,e)})}catch(d){return typeof console!=c&&console.log(d),!1}return b!=null},a}();